<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[ä½¿ç”¨VS2015ç¼–è¯‘Cocos2dx-3.2é¡¹ç›®]]></title>
      <url>/blog/2018/Build-cocos2dx-3_2-project-with-VS2015.html</url>
      <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><hr>
<p>&emsp;&emsp;cocos2dx3.2åº”è¯¥ç®—æ˜¯å¤§å®¶æ¯”è¾ƒç†ŸçŸ¥çš„ä¸€ä¸ªç‰ˆæœ¬äº†ï¼Œç›¸æ¯”åç»­çš„ç‰ˆæœ¬ï¼Œè¿™ä¸ªç‰ˆæœ¬ç”Ÿæˆçš„apkæ¯”è¾ƒå°ï¼Œé‡ç‚¹æ˜¯æ”¯æŒWP8ï¼ˆè½¯ç²‰ä¸€æš(à¸‡ â€¢_â€¢)à¸‡ï¼‰ï¼Œç„¶è€Œè¿™ä¸ªç‰ˆæœ¬ç”Ÿæˆçš„é¡¹ç›®åœ¨VS2015ä¸Šç¼–è¯‘ä¸è¿‡ã€‚æ¥ä¸‹æ¥ä»‹ç»å¦‚ä½•ä¿®æ”¹ä½¿VS2015èƒ½å¤Ÿé¡ºåˆ©ç¼–è¯‘é¡¹ç›®ã€‚<a id="more"></a></p>
<h1 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h1><hr>
<p>&emsp;&emsp;ç”¨cocos2dx3.2åˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼ˆä»¥ä¸‹ç”¨<code>YourProject</code>è¡¨ç¤ºé¡¹ç›®è·¯å¾„ï¼‰ï¼Œåˆ›å»ºæˆåŠŸåç”¨VS2015æ‰“å¼€<code>proj.win32</code>ä¸‹çš„slnæ–‡ä»¶ï¼Œæ‰“å¼€æ—¶ä¼šå¼¹å‡ºä¸€ä¸ªå‡çº§VCç¼–è¯‘å™¨å’Œåº“çš„æç¤ºï¼Œç‚¹ç¡®è®¤å³å¯ã€‚ä¹‹åç¼–è¯‘æ•´ä¸ªè§£å†³æ–¹æ¡ˆï¼Œä¸å‡ºæ„å¤–çš„è¯ä¼šçœ‹åˆ°è¿™äº›æŠ¥é”™ï¼š<br><img src="../images/Cocos2dx/builderror.png" alt=""></p>
<h1 id="è§£å†³é”™è¯¯"><a href="#è§£å†³é”™è¯¯" class="headerlink" title="è§£å†³é”™è¯¯"></a>è§£å†³é”™è¯¯</h1><hr>
<p>&emsp;&emsp;æ¥ä¸‹æ¥è§£å†³è¿™äº›ç¼–è¯‘æŠ¥é”™ï¼ŒåŒå‡»æŠ¥é”™ä¿¡æ¯å¯ä»¥å®šä½åˆ°æ‰€åœ¨æ–‡ä»¶ä»¥åŠè¡Œã€‚</p>
<h2 id="æ— æ•ˆæ–‡æœ¬åç¼€XSTR"><a href="#æ— æ•ˆæ–‡æœ¬åç¼€XSTR" class="headerlink" title="æ— æ•ˆæ–‡æœ¬åç¼€XSTR"></a>æ— æ•ˆæ–‡æœ¬åç¼€<code>XSTR</code></h2><p>&emsp;&emsp;æŠ¥é”™æ–‡ä»¶ä¸º<code>YourProject\cocos2d\external\chipmunk\src\chipmunk.c(48)</code>ã€‚æŸ¥æ‰¾æŠ¥é”™ä¿¡æ¯å‘ç°ï¼ŒVS2015æ–°å¢äº†ç”¨æˆ·å®šä¹‰æ–‡æœ¬æ”¯æŒï¼Œè¯¦ç»†è§<a href="https://msdn.microsoft.com/zh-cn/library/dn919277.aspx" target="_blank" rel="noopener"><strong>MSDN:ç”¨æˆ·å®šä¹‰çš„æ–‡æœ¬</strong></a>ï¼Œè¿™é‡Œ<code>XSTR(CP_VERSION_MAJOR)&quot;.&quot;XSTR(CP_VERSION_MINOR)&quot;.&quot;XSTR(CP_VERSION_RELEASE)</code>åé¢ä¸¤ä¸ªXSTRç”±äºæ²¡æœ‰ç©ºæ ¼éš”å¼€ï¼Œæ‰€ä»¥è¢«è®¤ä¸ºæ˜¯ç”¨æˆ·å®šä¹‰çš„æ–‡æœ¬ï¼Œä½†å®é™…ä¸Šæ²¡æœ‰XSTRè¿™ä¸ªå®šä¹‰ï¼Œæ‰€ä»¥æŠ¥é”™ã€‚è§£å†³åŠæ³•å°±æ˜¯åœ¨åˆ†åˆ«åœ¨åé¢ä¸¤ä¸ª<code>XSTR</code>å‰é¢åŠ ä¸Šç©ºæ ¼ï¼Œå³ï¼š<code>XSTR(CP_VERSION_MAJOR)&quot;.&quot; XSTR(CP_VERSION_MINOR)&quot;.&quot; XSTR(CP_VERSION_RELEASE)</code>ã€‚</p>
<h2 id="snprintfå®å®šä¹‰å†²çª"><a href="#snprintfå®å®šä¹‰å†²çª" class="headerlink" title="snprintfå®å®šä¹‰å†²çª"></a><code>snprintf</code>å®å®šä¹‰å†²çª</h2><p>&emsp;&emsp;Macro definition of snprintf conflicts with Standard Library function declarationè¿™æ¡æŠ¥é”™ä¿¡æ¯çš„æ„æ€æ˜¯<code>snprintf</code>å®å®šä¹‰å’Œæ ‡å‡†åº“å®šä¹‰å†²çªï¼Œè¯´æ˜cocos2dxåœ¨å†…éƒ¨å®šä¹‰äº†<code>snprintf</code>å®ã€‚æŸ¥çœ‹è¾“å‡ºå¯ä»¥å‘ç°åœ¨è¿™æ¡æŠ¥é”™ä¿¡æ¯å‰é¢è¿˜æœ‰ä¸€æ¡è­¦å‘Šä¿¡æ¯ï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1&gt;C:\Program Files (x86)\Windows Kits\10\Include\10.0.10240.0\ucrt\stdio.h(1925): warning C4005: \<span class="string">'snprintf\'</span>: macro redefinition (compiling <span class="built_in">source</span> file ..\base\atitc.cpp)</span><br><span class="line">1&gt;  YourProject\cocos2d\cocos\platform\win32\CCStdC.h(53): note: see previous definition of \<span class="string">'snprintf\'</span> (compiling <span class="built_in">source</span> file ..\base\atitc.cpp)</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;å®šä½åˆ°CCStdC.hæ–‡ä»¶53è¡Œï¼Œå¯ä»¥çœ‹åˆ°snprintfå®çš„å®šä¹‰ï¼Œè§£å†³åŠæ³•å°±æ˜¯æŠŠ<code>#define snprintf _snprintf</code>æ³¨é‡Šæ‰ã€‚<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// for math.h on win32 platform</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __MINGW32__</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> !defined(_USE_MATH_DEFINES)</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> _USE_MATH_DEFINES       <span class="comment">// make M_PI can be use</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> !defined(isnan)</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> isnan   _isnan</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> snprintf</span></span><br><span class="line"><span class="comment">//#define snprintf _snprintf    // æ³¨é‡Šæ‰è¿™ä¸€è¡Œå³å¯</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// __MINGW32__</span></span></span><br></pre></td></tr></table></figure></p>
<h2 id="æ— æ³•è§£æçš„å¤–éƒ¨ç¬¦å·"><a href="#æ— æ³•è§£æçš„å¤–éƒ¨ç¬¦å·" class="headerlink" title="æ— æ³•è§£æçš„å¤–éƒ¨ç¬¦å·"></a>æ— æ³•è§£æçš„å¤–éƒ¨ç¬¦å·</h2><p>&emsp;&emsp;ç¼–è¯‘é”™è¯¯è§£å†³äº†ä¹‹åï¼Œé‡æ–°ç¼–è¯‘å‘ç°æœ‰é“¾æ¥é”™è¯¯ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3&gt;libpng.lib(pngerror.obj) : error LNK2019: unresolved external symbol __imp____iob_func referenced <span class="keyword">in</span> <span class="keyword">function</span> _png_default_error</span><br><span class="line">3&gt;libtiff.lib(tif_unix.obj) : error LNK2001: unresolved external symbol __imp____iob_func</span><br><span class="line">3&gt;libjpeg.lib(jerror.obj) : error LNK2019: unresolved external symbol ___iob_func referenced <span class="keyword">in</span> <span class="keyword">function</span> _output_message</span><br><span class="line">3&gt;MSVCRTD.lib(vsnprintf.obj) : error LNK2001: unresolved external symbol __imp___vsnprintf</span><br></pre></td></tr></table></figure></p>
<h3 id="iob-func"><a href="#iob-func" class="headerlink" title="__iob_func"></a><code>__iob_func</code></h3><p>&emsp;&emsp;å‡ºç°<code>__iob_func</code>é“¾æ¥é”™è¯¯çš„åŸå› æ˜¯æ—©æœŸVSç‰ˆæœ¬æ˜¯ç”¨<code>__iob_func</code>æ¥å®šä¹‰<code>stdin</code>ã€<code>stdout</code>å’Œ<code>stderr</code>å®çš„ï¼Œè€ŒVS2015æ˜¯ç”¨<code>__acrt_iob_func</code>å®šä¹‰ï¼ˆä»¥SDK 10240ç‰ˆæœ¬ä¸ºä¾‹ï¼Œä¸‰ä¸ªå®å®šä¹‰åœ¨<code>c:\Program Files (x86)\Windows Kits\10\Include\10.0.10240.0\ucrt\corecrt_wstdio.h</code>ï¼‰ã€‚æœ‰ä»¥ä¸‹ä¸¤ç§è§£å†³åŠæ³•ï¼š</p>
<ol>
<li>è‡ªè¡Œç¼–è¯‘libpngã€libtiffå’Œlibjpegç”ŸæˆVS2015ç‰ˆæœ¬çš„libæ–‡ä»¶ï¼›</li>
<li>ä»cocos2dxæœ€æ–°ç‰ˆæœ¬ä¸­æ‹·è´libpngã€libtiffå’Œlibjpegçš„win32ç‰ˆæœ¬libæ–‡ä»¶åŠå¤´æ–‡ä»¶åˆ°cocos2dx3.2å¯¹åº”ç›®å½•<code>YourProject\cocos2d\external</code>ï¼ˆ<strong>ä¸å¸Œæœ›ä¸‹è½½cocos2dxæœ€æ–°ç‰ˆæœ¬ï¼ŸæŸ¥çœ‹ç»“æŸéƒ¨åˆ†ä¸‹è½½æˆ‘æä¾›çš„é™„ä»¶</strong>ï¼‰ï¼›<br>æ‹·è´å®Œæˆä¹‹åä¿®æ”¹<code>YourProject\cocos2d\cocos\platform\win32\CCPlatformDefine.h</code>ï¼Œåœ¨<code>#endif // CC_TARGET_PLATFORM == CC_PLATFORM_WIN32</code>ä¹‹å‰åŠ ä¸Šå¦‚ä¸‹ä»£ç ï¼š  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">if</span> _MSC_VER &gt;= 1900</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib,<span class="meta-string">"libpng-2015.lib"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib,<span class="meta-string">"libjpeg-2015.lib"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib,<span class="meta-string">"libtiff-2015.lib"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib,<span class="meta-string">"libpng.lib"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib,<span class="meta-string">"libjpeg.lib"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib,<span class="meta-string">"libtiff.lib"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="vsnprintf"><a href="#vsnprintf" class="headerlink" title="__vsnprintf"></a><code>__vsnprintf</code></h3><p></p><p>&emsp;&emsp;å‡ºç°è¿™ä¸ªé—®é¢˜çš„åŸå› å‚è€ƒ<a href="https://social.msdn.microsoft.com/Forums/en-US/5150eeec-4427-440f-ab19-aecb26113d31/updated-to-vs-2015-and-now-get-unresolved-external-errors?forum=vcgeneral" target="_blank" rel="noopener"><strong>MSDN Socialï¼šUpdated to VS 2015 and now get Unresolved External Errors</strong></a>ï¼Œè§£å†³åŠæ³•æ˜¯åœ¨å¯åŠ¨é¡¹ç›®å±æ€§ä¸­çš„é“¾æ¥å™¨-&gt;è¾“å…¥-&gt;é™„åŠ ä¾èµ–é¡¹ä¸­åŠ ä¸Š<code>legacy_stdio_definitions.lib</code>ã€‚</p><br><img src="../images/Cocos2dx/add_stdio_definitions_lib.png" alt=""><p></p>
<h1 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h1><hr>
<p>&emsp;&emsp;åˆ°è¿™é‡Œæ‰€æœ‰é—®é¢˜éƒ½å·²ç»è§£å†³ï¼Œå¯ä»¥ç”¨VS2015æ„‰å¿«çš„å†™ä»£ç äº†ğŸ˜˜<br>&emsp;&emsp;æœ€åé™„ä¸Šcocos2dx3.14.1ç‰ˆæœ¬çš„libpngã€libtiffå’Œlibjpegåº“ç›¸å…³æ–‡ä»¶ï¼ŒåŒ…å«ä¸‰ä¸ªåº“çš„win32ç‰ˆæœ¬includeå’Œprebuiltç›®å½•ï¼Œä¸‹è½½åœ°å€<a href="../attachments/cocos2d.zip"><strong>ç‚¹è¿™é‡Œ</strong></a>ï¼Œä¸‹è½½ä¹‹åç›´æ¥æ›¿æ¢ä½ çš„é¡¹ç›®ä¸‹çš„cocos2dç›®å½•å³å¯ã€‚</p>
]]></content>
      
        <categories>
            
            <category> Cocos2dx </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Cocos2dx </tag>
            
            <tag> VS2015 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Triggerç¬¬ä¸‰ç¯‡ï¼šåˆ›å»ºã€è¯»å–å’Œå†™å…¥jsonæ–‡ä»¶]]></title>
      <url>/blog/2015/TS3-create-read-write-data-with-json.html</url>
      <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><hr>
<p>&#160; &#160; &#160; &#160;ä¸Šä¸€ç¯‡å…¶å®å·²ç»è¯´å®Œäº†è¿™ä¸ªæ¸¸æˆé‡Œçš„é‡è¦éƒ¨åˆ†äº†ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥å¼€å§‹å†™ä»£ç äº†ã€‚å…ˆä»è§£æjsonæ–‡ä»¶å¼€å§‹ï¼Œé…ç½®ç¯å¢ƒå•¥çš„å°±ä¸å†™äº†ï¼Œç½‘ä¸Šä¸€æœå¤§æŠŠçš„æ•™ç¨‹ï¼ˆæ„Ÿè§‰è¿™éƒ¨åˆ†å…¶å®éƒ½ä¸ç”¨å†™ï¼Œä¹Ÿæœ‰ç±»ä¼¼è¯»å–jsonæ–‡ä»¶çš„æ•™ç¨‹= =ï¼‰<a id="more"></a></p>
<h1 id="åœ°å›¾æ•°æ®json"><a href="#åœ°å›¾æ•°æ®json" class="headerlink" title="åœ°å›¾æ•°æ®json"></a>åœ°å›¾æ•°æ®json</h1><hr>
<p>&#160; &#160; &#160; &#160;è¿™é‡Œä½¿ç”¨rapidjsonè¯»å–jsonæ–‡ä»¶ã€‚ä»¥3.2ç‰ˆæœ¬ä¸ºä¾‹ï¼Œrapidjsonå¤´æ–‡ä»¶åœ¨é¡¹ç›®ç›®å½•\cocos2d\external\jsonä¸‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="../images/Trigger/rapidjson.png" alt="rapidjson"><br>&#160; &#160; &#160; &#160;åœ¨ä½¿ç”¨rapidjsonå‰ï¼Œéœ€è¦å¼•å…¥ä»¥ä¸‹å¤´æ–‡ä»¶ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"json/rapidjson.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"json/writer.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"json/document.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"json/prettywriter.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"json/stringbuffer.h"</span></span></span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;æ¥ä¸‹æ¥ä¸Šåœ°å›¾é…ç½®åŠ è½½çš„ä»£ç ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åŠ è½½jsonå¹¶è§£æ</span></span><br><span class="line"><span class="keyword">bool</span> CDataManager::LoadMapData()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">string</span> strContent = FileUtils::getInstance()-&gt;getStringFromFile(MAP_FILE_PATH);</span><br><span class="line"></span><br><span class="line">	rapidjson::Document oDoc;</span><br><span class="line">	oDoc.Parse&lt;<span class="number">0</span>&gt;(strContent.c_str());</span><br><span class="line">	<span class="keyword">if</span> (oDoc.HasParseError())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">log</span>(<span class="string">"Parse Error: %s\n"</span>, oDoc.GetParseError());</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (oDoc.IsNull() || !oDoc.IsArray())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; oDoc.Size(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		MapInfo mapInfo;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//color</span></span><br><span class="line">		<span class="keyword">if</span> (oDoc[i][<span class="string">"color"</span>].IsNull())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		mapInfo.iColor = oDoc[i][<span class="string">"color"</span>].GetInt();</span><br><span class="line"></span><br><span class="line">		<span class="comment">//id</span></span><br><span class="line">		<span class="keyword">if</span> (oDoc[i][<span class="string">"id"</span>].IsNull())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		mapInfo.iID = oDoc[i][<span class="string">"id"</span>].GetInt();</span><br><span class="line"></span><br><span class="line">		<span class="comment">//beat</span></span><br><span class="line">		<span class="keyword">if</span> (oDoc[i][<span class="string">"beat"</span>].IsNull())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		mapInfo.iBeat = oDoc[i][<span class="string">"beat"</span>].GetInt();</span><br><span class="line"></span><br><span class="line">		<span class="comment">//map</span></span><br><span class="line">		<span class="keyword">if</span> (oDoc[i][<span class="string">"map"</span>].IsNull() || (!oDoc[i][<span class="string">"map"</span>].IsArray()))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//æ¯è¡Œæ•°æ®</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; oDoc[i][<span class="string">"map"</span>].Size(); j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (oDoc[i][<span class="string">"map"</span>][j].IsNull() </span><br><span class="line">				|| (!oDoc[i][<span class="string">"map"</span>][j].IsArray()))</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; oDoc[i][<span class="string">"map"</span>][j].Size(); k++)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span> (oDoc[i][<span class="string">"map"</span>][j][k].IsNull())</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> iValue = oDoc[i][<span class="string">"map"</span>][j][k].GetInt();</span><br><span class="line">				<span class="comment">//æ¯è¡Œæ•°æ®å­˜å…¥vecMapä¸­</span></span><br><span class="line">				mapInfo.vecMap.push_back(iValue);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//mapitem</span></span><br><span class="line">		<span class="keyword">if</span> (oDoc[i][<span class="string">"mapitem"</span>].IsNull() </span><br><span class="line">			|| (!oDoc[i][<span class="string">"mapitem"</span>].IsArray()))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; oDoc[i][<span class="string">"mapitem"</span>].Size(); j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (oDoc[i][<span class="string">"mapitem"</span>][j].IsNull())</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">string</span> strMapItem = oDoc[i][<span class="string">"mapitem"</span>][j].GetString();</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> iArrow[<span class="number">3</span>] = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">			SplitString(strMapItem, <span class="string">'_'</span>, iArrow);</span><br><span class="line"></span><br><span class="line">			ArrowInfo arrowInfo;</span><br><span class="line">			<span class="comment">//Xå’ŒYä½ç½®äº’æ¢</span></span><br><span class="line">			arrowInfo.iY = iArrow[<span class="number">0</span>];</span><br><span class="line">			arrowInfo.iX = iArrow[<span class="number">1</span>];</span><br><span class="line">			arrowInfo.iType = iArrow[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">			<span class="comment">//å­˜å…¥vecMapItemä¸­</span></span><br><span class="line">			mapInfo.vecMapItem.push_back(arrowInfo);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//useritem</span></span><br><span class="line">		<span class="keyword">if</span> (oDoc[i][<span class="string">"useritem"</span>].IsNull() </span><br><span class="line">			|| (!oDoc[i][<span class="string">"useritem"</span>].IsArray()))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; oDoc[i][<span class="string">"useritem"</span>].Size(); j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (oDoc[i][<span class="string">"useritem"</span>][j].IsNull())</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">int</span> iNum = oDoc[i][<span class="string">"useritem"</span>][j].GetInt();</span><br><span class="line"></span><br><span class="line">			mapInfo.vecUserItem.push_back(iNum);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		m_oMapVec.push_back(mapInfo);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;ä»¥ä¸Šä»£ç æ¶‰åŠåˆ°äº†ä¸¤ä¸ªç»“æ„ä½“ï¼ŒMapInfoå’ŒArrowInfoï¼Œå¯¹åº”å®šä¹‰å¦‚ä¸‹ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç®­å¤´ä¿¡æ¯</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ArrowInfo</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">int</span> iX;		<span class="comment">//æ¨ªå‘ä½ç½®ç´¢å¼•</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> iY;		<span class="comment">//çºµå‘ä½ç½®ç´¢å¼•</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> iType;	<span class="comment">//ç®­å¤´ç±»å‹</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MapInfo</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">int</span> iColor;	<span class="comment">//é¢œè‰²åºå·ï¼Œä¹Ÿæ˜¯ä¸»é¢˜åºå·</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> iID;	<span class="comment">//å…³å¡ID</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> iBeat;	<span class="comment">//å¯ç‚¹å‡»æ¬¡æ•°</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vecMap;	<span class="comment">//å…­è¾¹å½¢è¡Œåˆ—åˆ†å¸ƒåºåˆ—</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">vector</span>&lt;ArrowInfo&gt; vecMapItem;	<span class="comment">//åœ°å›¾ä¸­ç®­å¤´åˆ†å¸ƒ</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vecUserItem;	<span class="comment">//å¯ç”¨ç®­å¤´æ•°æ®</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;å¦å¤–è¿˜æœ‰ä¸€ä¸ªå‡½æ•°SplitStringï¼Œå…¶è´Ÿè´£è§£æå‡ºå­—ç¬¦ä¸²ä¸­çš„ä¸‰ä¸ªæ•°å€¼ï¼Œä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç§»é™¤stringä¸­æ‰€æœ‰ä½ç½®å‡ºç°è¿‡çš„æŸä¸ªå­—ç¬¦</span></span><br><span class="line"><span class="keyword">void</span> CDataManager::SplitString(<span class="built_in">string</span> &amp;srcStr, <span class="keyword">char</span> chTarget, <span class="keyword">int</span>* pArray)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">int</span> iPos = srcStr.find_first_of(<span class="string">'_'</span>);</span><br><span class="line">	<span class="built_in">string</span> strTemp = srcStr.substr(<span class="number">0</span>, iPos);</span><br><span class="line">	pArray[<span class="number">0</span>] = atoi(strTemp.c_str());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> iNewPos = srcStr.find_first_of(<span class="string">'_'</span>, iPos + <span class="number">1</span>);</span><br><span class="line">	strTemp = srcStr.substr(iPos + <span class="number">1</span>, iNewPos - iPos - <span class="number">1</span>);</span><br><span class="line">	pArray[<span class="number">1</span>] = atoi(strTemp.c_str());</span><br><span class="line"></span><br><span class="line">	iPos = srcStr.find_first_of(<span class="string">'_'</span>, iNewPos + <span class="number">1</span>);</span><br><span class="line">	strTemp = srcStr.substr(iNewPos + <span class="number">1</span>, iPos - iNewPos - <span class="number">1</span>);</span><br><span class="line">	pArray[<span class="number">2</span>] = atoi(strTemp.c_str());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="è¿›åº¦æ•°æ®json"><a href="#è¿›åº¦æ•°æ®json" class="headerlink" title="è¿›åº¦æ•°æ®json"></a>è¿›åº¦æ•°æ®json</h1><hr>
<p>&#160; &#160; &#160; &#160;ç°åœ¨éœ€è¦è€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼Œæ¸¸æˆçš„è¿›åº¦è¯¥å¦‚ä½•ä¿å­˜ï¼Ÿä½¿ç”¨UserDefaultç±»ï¼Ÿå¾ˆæ˜¾ç„¶æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºéœ€è¦è®°å½•æ¯ä¸ªå…³å¡çš„åˆ†æ•°æƒ…å†µï¼Œ200ä¸ªå…³å¡ç”¨UserDefaultå»å­˜å‚¨çš„è¯æ˜¾ç„¶å¤Ÿå‘›ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥è€ƒè™‘ä½¿ç”¨jsonæ–‡ä»¶ä¿å­˜æ¸¸æˆè¿›åº¦æ•°æ®ï¼ˆå½“ç„¶ï¼Œç”¨xmlä¹Ÿæ˜¯å¯ä»¥çš„ï¼‰ã€‚è¿›åº¦æ•°æ®æ–‡ä»¶æ ¼å¼å¦‚ä¸‹ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">"score"</span>:600,<span class="string">"level"</span>:200,<span class="string">"data"</span>:[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]&#125;</span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;å…ˆå†™ä¸ªåˆ›å»ºè¿›åº¦æ•°æ®æ–‡ä»¶çš„å‡½æ•°ã€‚å› ä¸ºç¬¬ä¸€æ¬¡æ‰“å¼€æ¸¸æˆæ—¶ï¼Œè¿›åº¦æ˜¯æœ¨æœ‰çš„ï¼Œæ‰€ä»¥éœ€è¦å…ˆå»ºå¥½è¿›åº¦æ•°æ®æ–‡ä»¶ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> CDataManager::InitUserData(<span class="keyword">const</span> <span class="keyword">char</span>* pName)</span><br><span class="line">&#123;</span><br><span class="line">	rapidjson::Document oWriteDoc;</span><br><span class="line">	oWriteDoc.SetObject();</span><br><span class="line">	rapidjson::Document::AllocatorType&amp; allocator = oWriteDoc.GetAllocator();</span><br><span class="line">	rapidjson::<span class="function">Value <span class="title">oArray</span><span class="params">(rapidjson::kArrayType)</span></span>;</span><br><span class="line"></span><br><span class="line">	oWriteDoc.AddMember(<span class="string">"score"</span>, <span class="number">0</span>, allocator);</span><br><span class="line">	oWriteDoc.AddMember(<span class="string">"level"</span>, <span class="number">0</span>, allocator);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//åˆå§‹åŒ–æ•°æ®</span></span><br><span class="line">	m_stUserInfo.iLevel = <span class="number">0</span>;</span><br><span class="line">	m_stUserInfo.iScore = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; TOTAL_LEVEL_NUM; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		m_stUserInfo.vecData.push_back(<span class="number">0</span>);</span><br><span class="line">		oArray.PushBack(<span class="number">0</span>, allocator);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	oWriteDoc.AddMember(<span class="string">"data"</span>, oArray, allocator);</span><br><span class="line"></span><br><span class="line">	rapidjson::StringBuffer oBuffer;</span><br><span class="line">	rapidjson::Writer&lt;rapidjson::StringBuffer&gt; oWriter(oBuffer);</span><br><span class="line">	oWriteDoc.Accept(oWriter);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//å†™å…¥</span></span><br><span class="line">	FILE* pFile = fopen(pName, <span class="string">"wb+"</span>);</span><br><span class="line">	<span class="keyword">if</span> (pFile == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">log</span>(<span class="string">"Open File '%s' Failed."</span>, pName);</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fputs</span>(oBuffer.GetString(), pFile);</span><br><span class="line">	fclose(pFile);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;è¿™é‡Œä¼ å…¥å‚æ•°pNameå³è¦å†™å…¥çš„è¿›åº¦æ•°æ®æ–‡ä»¶è·¯å¾„ï¼Œç”±äºåˆ›å»ºæ—¶æ²¡æœ‰è¿›åº¦ï¼Œæ‰€ä»¥scoreå’Œleveléƒ½æ˜¯0ï¼Œå„ä¸ªå…³å¡åˆ†æ•°è®°å½•ä¹Ÿæ˜¯0ã€‚<br>&#160; &#160; &#160; &#160;æ¥ä¸‹æ¥å†™åŠ è½½è¿›åº¦æ•°æ®æ–‡ä»¶çš„å‡½æ•°ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åŠ è½½ç”¨æˆ·æ•°æ®</span></span><br><span class="line"><span class="keyword">bool</span> CDataManager::LoadUserData()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">string</span> strPath = FileUtils::getInstance()-&gt;getWritablePath() + <span class="built_in">string</span>(SAVE_DATA_PATH);</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _DEBUG_</span></span><br><span class="line">	<span class="built_in">log</span>(<span class="string">"UserData Path:%s\n"</span>, strPath.c_str());</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">string</span> strContent = FileUtils::getInstance()-&gt;getStringFromFile(strPath);</span><br><span class="line">	rapidjson::Document oDoc;</span><br><span class="line">	oDoc.Parse&lt;<span class="number">0</span>&gt;(strContent.c_str());</span><br><span class="line">	<span class="keyword">if</span> (oDoc.HasParseError() || oDoc.IsNull())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//log("CDataManager::LoadUserData Load 'oDoc' Error.");</span></span><br><span class="line">		InitUserData(strPath.c_str());</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//å½“å‰è·å¾—çš„åˆ†æ•°</span></span><br><span class="line">	<span class="keyword">if</span> (oDoc[<span class="string">"score"</span>].IsNull())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">log</span>(<span class="string">"CDataManager::LoadUserData Load 'score' Error."</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	m_stUserInfo.iScore = oDoc[<span class="string">"score"</span>].GetInt();</span><br><span class="line"></span><br><span class="line">	<span class="comment">//å·²é€šè¿‡å…³å¡æ•°é‡ï¼Œå› ä¸ºä¸å¯èƒ½è·¨å…³å¡ï¼Œæ‰€ä»¥ä¹Ÿè¡¨ç¤ºå½“å‰é€šè¿‡çš„æœ€åä¸€å…³</span></span><br><span class="line">	<span class="keyword">if</span> (oDoc[<span class="string">"level"</span>].IsNull())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">log</span>(<span class="string">"CDataManager::LoadUserData Load 'level' Error."</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	m_stUserInfo.iLevel = oDoc[<span class="string">"level"</span>].GetInt();</span><br><span class="line"></span><br><span class="line">	<span class="comment">//æ‰€æœ‰å…³å¡å½“å‰ä¿¡æ¯</span></span><br><span class="line">	<span class="keyword">if</span> (oDoc[<span class="string">"data"</span>].IsNull() || (!oDoc[<span class="string">"data"</span>].IsArray()))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">log</span>(<span class="string">"CDataManager::LoadUserData Load 'data' Error."</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; oDoc[<span class="string">"data"</span>].Size(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (oDoc[<span class="string">"data"</span>][i].IsNull())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">log</span>(<span class="string">"CDataManager::LoadUserData Load 'oDoc[data][%d]' Error."</span>, i);</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> iValue = oDoc[<span class="string">"data"</span>][i].GetInt();</span><br><span class="line">		m_stUserInfo.vecData.push_back(iValue);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé»˜è®¤å½“è¿›åº¦æ•°æ®jsonæ–‡ä»¶è¯»å–å¤±è´¥æ—¶ï¼Œè¯´æ˜jsonæ–‡ä»¶ä¸å­˜åœ¨ï¼Œéœ€è¦é‡æ–°å»ºç«‹ï¼Œå³è°ƒç”¨InitUserDataå‡½æ•°åˆ›å»ºè¿›åº¦æ•°æ®æ–‡ä»¶ã€‚m_stUserInfoä¸­ä¿å­˜äº†è¯»å–çš„è¿›åº¦æ•°æ®ï¼Œå…¶ç±»å‹æ˜¯UserInfoç»“æ„ä½“ç±»å‹ï¼ŒUserInfoå®šä¹‰å¦‚ä¸‹ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">UserInfo</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">int</span> iScore;		<span class="comment">//åˆ†æ•°</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> iLevel;		<span class="comment">//å½“å‰é€šè¿‡å…³å¡æ•°</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vecData;	<span class="comment">//å…³å¡å¾—åˆ†æ•°æ®</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;æœ‰äº†è¯»å–å‡½æ•°å½“ç„¶å°‘ä¸äº†å†™å…¥å‡½æ•°ï¼Œè¿›åº¦æ•°æ®ä¿å­˜å‡½æ•°å¦‚ä¸‹ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç”¨æˆ·æ•°æ®å†™å…¥åˆ°æŒ‡å®šæ–‡ä»¶ä¸­</span></span><br><span class="line"><span class="keyword">bool</span> CDataManager::SaveUserData()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">string</span> strPath = FileUtils::getInstance()-&gt;getWritablePath() + <span class="built_in">string</span>(SAVE_DATA_PATH);</span><br><span class="line">	<span class="built_in">string</span> strContent = FileUtils::getInstance()-&gt;getStringFromFile(strPath);</span><br><span class="line">	rapidjson::Document oDoc;</span><br><span class="line">	oDoc.Parse&lt;<span class="number">0</span>&gt;(strContent.c_str());</span><br><span class="line">	<span class="keyword">if</span> (oDoc.HasParseError())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">log</span>(<span class="string">"Parse Error: %s\n"</span>, oDoc.GetParseError());</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (oDoc.IsNull())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//æ›´æ–°åˆ†æ•°</span></span><br><span class="line">	<span class="keyword">if</span> (oDoc[<span class="string">"score"</span>].IsNull())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	oDoc[<span class="string">"score"</span>].SetInt(m_stUserInfo.iScore);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//æ›´æ–°é€šè¿‡çš„å…³å¡æ•°é‡</span></span><br><span class="line">	<span class="keyword">if</span> (oDoc[<span class="string">"level"</span>].IsNull())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	oDoc[<span class="string">"level"</span>].SetInt(m_stUserInfo.iLevel);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//æ›´æ–°å…³å¡å½“å‰ä¿¡æ¯</span></span><br><span class="line">	<span class="keyword">if</span> (oDoc[<span class="string">"data"</span>].IsNull() || !oDoc[<span class="string">"data"</span>].IsArray())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> iVecSize = m_stUserInfo.vecData.size();</span><br><span class="line">	<span class="keyword">int</span> iJsonSize = oDoc[<span class="string">"data"</span>].Size();</span><br><span class="line">	<span class="keyword">if</span> (iVecSize != iJsonSize)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">log</span>(<span class="string">"Error: %d(iVecSize) != %d(iJsonSize)\n"</span>, iVecSize, iJsonSize);</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (rapidjson::SizeType i = <span class="number">0</span>; i &lt; oDoc[<span class="string">"data"</span>].Capacity(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (oDoc[<span class="string">"data"</span>][i].IsNull())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		oDoc[<span class="string">"data"</span>][i].SetInt(m_stUserInfo.vecData[i]);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//å‡†å¤‡å†™å…¥æ•°æ®</span></span><br><span class="line">	rapidjson::StringBuffer oBuffer;</span><br><span class="line">	rapidjson::Writer&lt;rapidjson::StringBuffer&gt; oWriter(oBuffer);</span><br><span class="line">	oDoc.Accept(oWriter);</span><br><span class="line"></span><br><span class="line">	FILE* pFile = fopen(strPath.c_str(), <span class="string">"wb+"</span>);</span><br><span class="line">	<span class="keyword">if</span> (pFile == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">log</span>(<span class="string">"Error: Open File '%s' Failed.\n"</span>, strPath.c_str());</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fputs</span>(oBuffer.GetString(), pFile);</span><br><span class="line">	fclose(pFile);</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _DEBUG_</span></span><br><span class="line">	<span class="built_in">log</span>(<span class="string">"UserDataPath:%s"</span>, strPath.c_str());</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;å¥½äº†ï¼Œjsonæ–‡ä»¶åˆ›å»ºã€è¯»å–å’Œå†™å…¥éƒ¨åˆ†å…ˆè¯´åˆ°è¿™ï¼Œå¦‚æœæœ‰ä»€ä¹ˆä¸æ˜ç™½çš„åœ°æ–¹å¯ä»¥è”ç³»æˆ‘ã€‚</p>
]]></content>
      
        <categories>
            
            <category> Trigger </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Trigger </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Triggerç¬¬äºŒç¯‡ï¼šå…³å¡å¸ƒå±€]]></title>
      <url>/blog/2015/TS2-map-layout.html</url>
      <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><hr>
<p>&#160; &#160; &#160; &#160;åŸæœ¬æ‰“ç®—å†™å¦‚ä½•æŠŠjsonè½¬æ¢ä¸ºplistæ–‡ä»¶ï¼Œä½†æ˜¯åæ¥å‘ç°æœ‰äº›é—®é¢˜ï¼Œæ‰€ä»¥æš‚æ—¶å…ˆä¸å†™äº†ï¼Œç­‰ä»¥åæœ‰æ—¶é—´è¡¥ä¸Šã€‚è¿™ä¸€ç¯‡å†™å†™æœ€ä¸»è¦çš„éƒ¨åˆ†ï¼šå…³å¡çš„å¸ƒå±€ã€‚<a id="more"></a></p>
<h1 id="å…³å¡åœ°å›¾"><a href="#å…³å¡åœ°å›¾" class="headerlink" title="å…³å¡åœ°å›¾"></a>å…³å¡åœ°å›¾</h1><hr>
<p>&#160; &#160; &#160; &#160;ç¬¬ä¸€ç¯‡é‡Œç®€å•çš„è¯´æ˜äº†ä¸‹åœ°å›¾æ–‡ä»¶levelmap.jsoné‡Œçš„æ•°æ®ï¼Œæ¯ä¸€å…³éƒ½æœ‰ä¸€ä¸ªå¤šä¸ªå…­è¾¹å½¢çš„ç»„æˆçš„åœ°å›¾ï¼ˆæš‚ä¸”ç§°ä¹‹ä¸ºåœ°å›¾å§ï¼‰ï¼Œå¥‡æ•°è¡ŒåŒ…å«7ä¸ªæ•°å­—ï¼Œå¶æ•°è¡ŒåŒ…å«6ä¸ªæ•°å­—ï¼Œä¹‹æ‰€ä»¥è¿™ä¹ˆå®‰æ’æ˜¯ä¸ºäº†ä½¿æ•´ä¸ªåœ°å›¾å¯ä»¥å±…ä¸­å¯¹é½ã€‚<br>&#160; &#160; &#160; &#160;ä»¥ç¬¬ä¸€ä¸ªä¸»é¢˜ï¼ˆå³å¤§å…³å¡ï¼Œæš‚ä¸”ç§°ä¹‹ä¸ºä¸»é¢˜ï¼‰ç¬¬1ä¸ªå…³å¡åœ°å›¾ä¸ºä¾‹ï¼Œå…¶åœ°å›¾æ•°æ®å¦‚ä¸‹ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"color"</span>:0,  <span class="string">"id"</span>:1</span><br><span class="line">...</span><br><span class="line">[0,1,1,1,0,0,0],</span><br><span class="line">[1,2,2,1,0,0],</span><br><span class="line">[1,2,2,2,1,0,0],</span><br><span class="line">[1,2,2,1,0,0],</span><br><span class="line">[0,1,1,1,0,0,0],</span><br><span class="line">[0,0,0,0,0,0],</span><br><span class="line">[0,0,0,0,0,0,0],</span><br><span class="line">[0,0,0,0,0,0],</span><br><span class="line">[0,0,0,0,0,0,0]</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;å…¶ä¸­0è¡¨ç¤ºè¯¥ä½ç½®æ— å…­è¾¹å½¢ï¼Œ1è¡¨ç¤ºç™½è‰²å…­è¾¹å½¢ï¼Œ2è¡¨ç¤ºä¸»é¢˜è‰²å…­è¾¹å½¢ï¼Œä¸»é¢˜è‰²åºå·å³å…³å¡å±æ€§ä¸­çš„colorå­—æ®µã€‚å…ˆè¯•ç€æŠŠæ•´ä¸ªåœ°å›¾ç”»å‡ºæ¥ï¼ˆå¿½ç•¥æ¯è¡Œä¸¤ä¸ªå…­è¾¹å½¢ä¹‹é—´çš„é—´è·ï¼‰ï¼š<br><img src="../images/Trigger/map1.png" alt="åˆæ­¥çš„åœ°å›¾"><br>&#160; &#160; &#160; &#160;å‘ç°é—®é¢˜äº†æ²¡ï¼Œå—¯ï¼Œæ²¡æœ‰å…­è¾¹å½¢çš„ä½ç½®å®é™…ä¸Šä¹Ÿæ˜¯éœ€è¦ç©ºå‡ºæ¥çš„ï¼Œå†è¯•ç€é‡æ–°ç”»ä¸€æ¬¡ï¼š<br><img src="../images/Trigger/map2.png" alt="ä¿ç•™äº†ç©ºç™½ä½ç½®"><br>&#160; &#160; &#160; &#160;è¿™å›å¥½åƒå’Œç›®æ ‡åœ°å›¾æœ‰é‚£ä¹ˆç‚¹åƒäº†ï¼Œä½†æ˜¯è¿˜æ˜¯ä¸å¤ªå¯¹ï¼Œè¯•ç€æŠŠæ¯è¡Œå±…ä¸­è°ƒæ•´ä¸€ä¸‹ï¼š<br><img src="../images/Trigger/map3.png" alt="æ¯è¡Œå±…ä¸­"><br>&#160; &#160; &#160; &#160;è¿™å›å’Œç›®æ ‡åœ°å›¾æœ‰å…«åˆ†ç›¸ä¼¼äº†ï¼Œç„¶è€Œè¿˜æ˜¯æœ‰äº›é—®é¢˜ï¼Œä¸¤è¡Œä¹‹é—´çš„é—´è·å¤ªå¤§ï¼Œéœ€è¦å†ç¨å¾®è°ƒæ•´ä¸€ä¸‹ã€‚å—¯ï¼Œè¿™äº›æ˜¯ç»†èŠ‚é—®é¢˜ï¼Œå¯ä»¥åç»­åœ¨å†™ä»£ç æ—¶å»æ§åˆ¶ã€‚è¯´åˆ°è¿™ï¼Œåœ°å›¾ç»†èŠ‚è¿™ä¸€å—å°±å·®ä¸å¤šäº†ï¼Œå¥½åƒå¾ˆç®€å•å§ï¼Œç„¶è€Œæˆ‘åœ¨å†™çš„æ—¶å€™è°ƒè¯•äº†å¥½ä¹…ï¼Œæ‰æ€»ç®—å¼„å‡ºæ¥äº†= =</p>
<h1 id="æ•°å­—å’Œç®­å¤´"><a href="#æ•°å­—å’Œç®­å¤´" class="headerlink" title="æ•°å­—å’Œç®­å¤´"></a>æ•°å­—å’Œç®­å¤´</h1><hr>
<h2 id="æ•°å­—"><a href="#æ•°å­—" class="headerlink" title="æ•°å­—"></a>æ•°å­—</h2><hr>
<p>&#160; &#160; &#160; &#160;ä»ç¬¬å››ä¸ªä¸»é¢˜ç¬¬1å…³å¼€å§‹ï¼Œä¹‹åçš„éƒ¨åˆ†å…³å¡å°±æœ‰äº†æ•°å­—ï¼Œåˆ†ä¸ºä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š<br>&#160; &#160; &#160; &#160;1ã€å•ä¸ªä½ç½®æ•°å€¼&lt;10ï¼šè¯¥å…­è¾¹å½¢é¢œè‰²ä¸ºä¸»é¢˜è‰²ï¼Œæ•°å­—ä¸ºç™½è‰²ï¼Œæ•°å­—å€¼ä¸ºè¯¥ä½ç½®æ•°å€¼-2ã€‚ä¾‹å¦‚ï¼šæŸä¸ªä½ç½®æ•°å€¼ä¸º5ï¼Œé‚£ä¹ˆè¿™ä¸ªä½ç½®æ˜¯ä¸€ä¸ªä¸»é¢˜è‰²çš„å…­è¾¹å½¢ï¼ŒåŒ…å«äº†ä¸€ä¸ªç™½è‰²çš„æ•°å­—3ã€‚<br>&#160; &#160; &#160; &#160;2ã€å•ä¸ªä½ç½®æ•°å€¼&gt;20ï¼šè¯¥å…­è¾¹å½¢é¢œè‰²ä¸ºç™½è‰²ï¼Œæ•°å­—ä¸ºä¸»é¢˜è‰²ï¼Œæ•°å­—å€¼ä¸ºè¯¥ä½ç½®æ•°å€¼æœ€åä¸€ä½-1ã€‚ä¾‹å¦‚ï¼šæŸä¸ªä½ç½®æ•°å€¼ä¸º22ï¼Œé‚£ä¹ˆè¿™ä¸ªä½ç½®æ˜¯ä¸€ä¸ªç™½è‰²çš„å…­è¾¹å½¢ï¼ŒåŒ…å«äº†ä¸€ä¸ªä¸»é¢˜è‰²çš„æ•°å­—1ã€‚<br>&#160; &#160; &#160; &#160;ä»¥ç¬¬å››ä¸ªä¸»é¢˜ç¬¬6å…³ä¸ºä¾‹ï¼Œè¯¥åœ°å›¾åŒ…å«6ä¸ªæœ‰æ•°å­—çš„å…­è¾¹å½¢ï¼Œå…­è¾¹å½¢éƒ½æ˜¯ç™½è‰²ï¼Œæ•°å­—éƒ½æ˜¯ä¸»é¢˜è‰²ã€‚å…¶åœ°å›¾æ•°æ®å¦‚ä¸‹ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"color"</span>:3,  <span class="string">"id"</span>:6</span><br><span class="line">...</span><br><span class="line">[0,22,1,22,0,0,0],</span><br><span class="line">[2,1,1,2,0,0],</span><br><span class="line">[22,1,2,1,22,0,0],</span><br><span class="line">[1,1,1,1,0,0],</span><br><span class="line">[0,22,2,22,0,0,0],</span><br><span class="line">[0,0,0,0,0,0],</span><br><span class="line">[0,0,0,0,0,0,0],</span><br><span class="line">[0,0,0,0,0,0],</span><br><span class="line">[0,0,0,0,0,0,0]</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;ç¬¬å››ä¸ªä¸»é¢˜ç¬¬6å…³å…³å¡æˆªå›¾ï¼š<br><img src="../images/Trigger/map4-6.png" alt="ç¬¬å››ä¸ªä¸»é¢˜ç¬¬6å…³åœ°å›¾"></p>
<h2 id="ç®­å¤´"><a href="#ç®­å¤´" class="headerlink" title="ç®­å¤´"></a>ç®­å¤´</h2><hr>
<p>&#160; &#160; &#160; &#160;ä»ç¬¬ä¸‰ä¸ªä¸»é¢˜ç¬¬5å…³å¼€å§‹ï¼Œä¹‹åçš„éƒ¨åˆ†å…³å¡å°±æœ‰äº†ç®­å¤´ï¼Œç®­å¤´å¯¹åº”çš„æ˜¯mapitemæ•°ç»„ä¸­çš„é…ç½®ï¼Œæ¯ä¸ªç®­å¤´æ•°æ®é…ç½®å¦‚ä¸‹å½¢å¼ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"y_x_arrow"</span></span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;æ˜¯çš„ï¼Œæ²¡æœ‰çœ‹é”™ï¼Œè¿™é‡Œxå’Œyçš„ä½ç½®ç´¢å¼•æ˜¯åè¿‡æ¥çš„ã€‚åé¢çš„arrowæ•°å€¼è¡¨ç¤ºç®­å¤´çš„åºå·ï¼Œç¬¬ä¸€ç¯‡ä¸­å·²ç»è¯´æ˜äº†ã€‚ä»¥ç¬¬ä¸‰ä¸ªä¸»é¢˜ç¬¬5å…³ä¸ºä¾‹ï¼Œå…³å¡åŒ…å«çš„ç®­å¤´é…ç½®å¦‚ä¸‹ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"color"</span>:2,  <span class="string">"id"</span>:5</span><br><span class="line">...</span><br><span class="line"><span class="string">"mapitem"</span>:[<span class="string">"0_1_3"</span>,<span class="string">"3_1_2"</span>,<span class="string">"2_2_4"</span>,<span class="string">"2_4_1"</span>]</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;æ¥çœ‹çœ‹ç¬¬ä¸‰ä¸ªä¸»é¢˜ç¬¬5å…³çš„å…³å¡æˆªå›¾ï¼š<br><img src="../images/Trigger/map3-5.png" alt="ç¬¬ä¸‰ä¸ªä¸»é¢˜ç¬¬5å…³åœ°å›¾"><br>&#160; &#160; &#160; &#160;ç¬¬ä¸‰ä¸ªä¸»é¢˜ç¬¬5å…³çš„åœ°å›¾æ•°æ®ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"color"</span>:2,  <span class="string">"id"</span>:5</span><br><span class="line">...</span><br><span class="line">[0,2,1,2,0,0,0],</span><br><span class="line">[2,1,1,2,0,0],</span><br><span class="line">[2,1,2,1,2,0,0],</span><br><span class="line">[1,1,1,1,0,0],</span><br><span class="line">[0,2,2,2,0,0,0],</span><br><span class="line">[0,0,0,0,0,0],</span><br><span class="line">[0,0,0,0,0,0,0],</span><br><span class="line">[0,0,0,0,0,0],</span><br><span class="line">[0,0,0,0,0,0,0]</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;å’Œç¬¬ä¸€ä¸ªä¸»é¢˜ç¬¬1å…³åœ°å›¾ç±»ä¼¼ï¼Œåªæ˜¯æœ‰äº›ä½ç½®é¢œè‰²å‘ç”Ÿäº†å˜åŒ–ã€‚å…ˆæ¥çœ‹çœ‹å·¦è¾¹çš„ç®­å¤´ï¼Œå·¦è¾¹çš„ç®­å¤´å¯¹åº”çš„æ˜¯mapitemé‡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯â€0_1_3â€ï¼š1ä¹Ÿå°±æ˜¯ç¬¬1è¡Œï¼ˆä»0å¼€å§‹ï¼‰ï¼Œ0ä¹Ÿå°±æ˜¯ç¬¬0åˆ—ï¼Œä¹Ÿå°±æ˜¯è¯´ç®­å¤´æ˜¯åœ¨ç¬¬2è¡Œç¬¬ä¸€ä¸ªæ•°å­—å¯¹åº”çš„å…­è¾¹å½¢ä½ç½®ï¼Œå®ƒçš„é¢œè‰²æ­£å¥½æ˜¯ä¸»é¢˜è‰²â€¦â€¦åé¢çš„æˆ‘æƒ³åº”è¯¥éƒ½å¯ä»¥çœ‹å‡ºæ¥äº†ã€‚</p>
<h2 id="å¯ç”¨ç®­å¤´"><a href="#å¯ç”¨ç®­å¤´" class="headerlink" title="å¯ç”¨ç®­å¤´"></a>å¯ç”¨ç®­å¤´</h2><hr>
<p>&#160; &#160; &#160; &#160;ä»ç¬¬ä¸‰ä¸ªä¸»é¢˜ç¬¬9å…³å¼€å§‹ï¼Œä¹‹åçš„éƒ¨åˆ†å…³å¡å°±æœ‰äº†å¯ç”¨ç®­å¤´ï¼Œå¯ç”¨ç®­å¤´åœ¨ä¸‹æ–¹5ä¸ªå…­è¾¹å½¢ä¸­ï¼Œé…ç½®å¯¹åº”å…³å¡é…ç½®ä¸­çš„useritemæ•°ç»„ã€‚ä»¥ç¬¬ä¸‰ä¸ªä¸»é¢˜ç¬¬10å…³ä¸ºä¾‹ï¼Œè¯¥å…³å¡ä¸­æœ‰3ä¸ªå¯ç”¨ç®­å¤´ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"color"</span>:2,  <span class="string">"id"</span>:10</span><br><span class="line">...</span><br><span class="line"><span class="string">"useritem"</span>:[3,2,4]</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;æ•°å­—3ã€2ã€4è¡¨ç¤ºç®­å¤´åºå·ï¼Œåˆ†åˆ«å¯¹åº”<img src="../images/Trigger/arrow3.png" alt="">ã€<img src="../images/Trigger/arrow2.png" alt="">å’Œ<img src="../images/Trigger/arrow4.png" alt="">ä¸‰ä¸ªç®­å¤´ã€‚å†æ¥çœ‹çœ‹å…³å¡æˆªå›¾ï¼š<br><img src="../images/Trigger/map3-10.png" alt="ç¬¬ä¸‰ä¸ªä¸»é¢˜ç¬¬10å…³"></p>
<h1 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h1><hr>
<p>&#160; &#160; &#160; &#160;å…³å¡å¸ƒå±€è¿™ä¸€å—å…ˆè¯´åˆ°è¿™ï¼Œä¸‹ä¸€ç¯‡è¯´è¯´åœ¨cocos2d-xä¸­è¯»å–jsonæ–‡ä»¶çš„é‚£äº›äº‹ã€‚</p>
]]></content>
      
        <categories>
            
            <category> Trigger </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Trigger </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Triggerç¬¬ä¸€ç¯‡ï¼šç®€ä»‹ä»¥åŠèµ„æºåˆ†æ]]></title>
      <url>/blog/2015/TS1-resources-analyze.html</url>
      <content type="html"><![CDATA[<h1 id="å¼€ç¯‡ä¹‹å‰"><a href="#å¼€ç¯‡ä¹‹å‰" class="headerlink" title="å¼€ç¯‡ä¹‹å‰"></a>å¼€ç¯‡ä¹‹å‰</h1><hr>
<p>&#160; &#160; &#160; &#160;æƒ³æƒ³å­¦Cocos2d-xè¿˜æ˜¯åœ¨å¤§å››ä¸Šå­¦æœŸå¼€å§‹çš„ï¼Œä»é‚£æ—¶åˆ°ç°åœ¨ï¼Œä¸€ç›´æƒ³åšä¸€ä¸ªè‡ªå·±çš„æ¸¸æˆï¼Œå¯èƒ½æ˜¯å› ä¸ºè‡ªå·±åˆ›æ„ä¸å¤Ÿå§ï¼Œä¸€ç›´æ²¡è¿™ä¸ªæœºä¼šï¼Œå¦å¤–ï¼Œå’Œè‡ªå·±çš„æ°´å¹³ä¹Ÿæœ‰å¾ˆå¤§å…³ç³»ã€‚è¿™æ¬¡åšçš„Triggerï¼Œä¾ç„¶æ˜¯ä»¿ç…§å†™çš„ï¼ˆä¹Ÿå°±æ˜¯èµ„æºæ˜¯æ‹¿æ¥çš„ï¼Œä»…ä»…æ˜¯ä»£ç æ˜¯æˆ‘å†™çš„= =ï¼‰ã€‚ä¸è¿‡è¿˜å¥½ï¼Œæ„Ÿè§‰è¿™æ¬¡åšçš„ä¹Ÿè¿˜è¡Œï¼Œå¤§éƒ¨åˆ†åŠŸèƒ½éƒ½åšå¥½äº†ï¼Œé™¤äº†ä¸€äº›å¸®åŠ©æ²¡åšï¼ˆä¼°è®¡ä¹Ÿæ²¡å¤šå°‘äººä¼šç©ï¼Œæ‰€ä»¥å¸®åŠ©å°±ä¸æ‰“ç®—åšäº†ï¼‰ã€‚å¦å¤–ï¼Œä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡å‘å¸ƒäº†WPç‰ˆï¼Œæ£é¼“äº†ä¸¤å¤©å¼„å‡ºæ¥äº†ï¼ŒæœŸé—´ä¹Ÿé‡åˆ°äº†å„ç§é—®é¢˜â€¦â€¦æ‰¯å¾—æœ‰ç‚¹è¿œäº†ã€‚<a id="more"></a></p>
<h1 id="Triggerä»‹ç»"><a href="#Triggerä»‹ç»" class="headerlink" title="Triggerä»‹ç»"></a>Triggerä»‹ç»</h1><hr>
<p>&#160; &#160; &#160; &#160;ä¸€å¼€å§‹ç©è¿™æ¸¸æˆçš„æ—¶å€™æ„Ÿè§‰è¿˜ä¸é”™ï¼Œè¶Šåˆ°åé¢è¶Šéš¾ï¼Œéš¾çš„éƒ½ä¸æƒ³ç©äº†ï¼ˆè™å¿ƒçš„æ¸¸æˆ(â•¯â€µâ–¡â€²)â•¯ï¸µâ”»â”â”»ï¼‰ï¼Œå…ˆæ¥æ®µåŸç‰ˆçš„ä»‹ç»ï¼ˆappé“¾æ¥ï¼š<a href="http://www.coolapk.com/game/com.orszdxet.java.TriggerApp/" target="_blank" rel="noopener">http://www.coolapk.com/game/com.orszdxet.java.TriggerApp/</a>ï¼‰ï¼š<br>&#160; &#160; &#160; &#160;æ©˜çº¢è‰²ä¸ç™½è‰²çš„å…­è¾¹å½¢ç›¸äº’æ¯”é‚»ï¼Œå½“ä½ ç‚¹å‡»å…¶ä¸­ä¸€å—æ—¶ï¼Œå®ƒä¼šè¿åŒç›¸é‚»çš„å›¾å½¢ä¸€èµ·å˜æ¢é¢œè‰²ã€‚è€Œä½ çš„ç›®æ ‡å°±æ˜¯è¦åœ¨æœ‰é™çš„ç‚¹å‡»æ¬¡æ•°å†…ï¼Œä½¿æ‰€æœ‰çš„å›¾å½¢éƒ½å˜ä¸ºç™½è‰²ã€‚<br>&#160; &#160; &#160; &#160;æ¯ä¸ªå…³å¡éƒ½ä¼šæœ‰æç¤ºæœ€ä½å®Œæˆæ­¥æ•°ï¼Œå½“ä½ è€—å°½ä¹‹åè¿˜ä¼šæœ‰é¢å¤–çš„10æ¬¡åŠ¨ä½œæœºä¼šã€‚ä»¥é™å®šçš„æ­¥æ•°å®Œæˆå°±ä¼šè·å¾—ä¸‰æ˜Ÿçš„è¯„ä»·ï¼Œåˆ©ç”¨é¢å¤–çš„æœºä¼šåˆ™ä¼šç›¸åº”é™ä½è¯„ä»·ï¼Œè¿½æ±‚æ»¡æ˜Ÿçš„ç©å®¶å°±è¦å¤šåŠ¨åŠ¨è„‘äº†ã€‚<br>&#160; &#160; &#160; &#160;æ¸¸æˆå†…æœ‰åå¤§å…³å¡ï¼Œæ¯ä¸ªå¤§å…³åˆæœ‰äºŒåå°å…³ï¼Œéš¾åº¦ä¼šä¸æ–­å¢åŠ ï¼Œå–œæ¬¢æŒ‘æˆ˜çš„ç©å®¶ç»å¯¹ä¸èƒ½é”™è¿‡ï¼<br>&#160; &#160; &#160; &#160;â˜…æ¸¸æˆç‰¹è‰²â˜…<br>&#160; &#160; &#160; &#160;â˜…â˜…â˜…â˜…â˜…ç®€å•æœ‰è¶£çš„ç©æ³•<br>&#160; &#160; &#160; &#160;â˜…â˜…â˜…â˜…â˜…å¤§æ–¹ç¾è§‚çš„å›¾å½¢<br>&#160; &#160; &#160; &#160;â˜…â˜…â˜…â˜…â˜…ä¸æ–­å‡çº§çš„æŒ‘æˆ˜<br>&#160; &#160; &#160; &#160;â˜…â˜…â˜…â˜…â˜…é”»ç‚¼ä½ çš„åˆ¤æ–­åŠ›<br>&#160; &#160; &#160; &#160;æ¥å‡ å¼ æ¸¸æˆçš„æˆªå›¾ï¼š<br><img src="../images/Trigger/menu.png" width="360" height="240" alt="èœå•ç•Œé¢" align="center"><br><img src="../images/Trigger/select.png" width="360" height="240" alt="é€‰å…³ç•Œé¢" align="center"><br><img src="../images/Trigger/game.png" width="360" height="240" alt="æ¸¸æˆç•Œé¢" align="center"></p>
<p>&#160; &#160; &#160; &#160;å—¯ï¼Œä»‹ç»å°±å…ˆåˆ°è¿™äº†ï¼Œå¦‚æœè¦äº†è§£æ›´å¤šå†…å®¹ï¼Œä¸‹è½½ä¸ªç©ç©å°±æ˜¯äº†â†’_â†’</p>
<h1 id="èµ„æºæå–"><a href="#èµ„æºæå–" class="headerlink" title="èµ„æºæå–"></a>èµ„æºæå–</h1><hr>
<p>&#160; &#160; &#160; &#160;ä¸‹è½½ä¸ªåŸç‰ˆapkç„¶åWinRARæ‰“å¼€ï¼Œæ‰¾åˆ°resourcesæ–‡ä»¶å¤¹ï¼ˆ\assets\egret-game\resourceï¼‰ï¼Œå…ˆæŠŠå®ƒè§£å‹å‡ºæ¥ã€‚<br><img src="../images/Trigger/unpack.png" alt="è§£å‹å‡ºæ¥çš„resourceæ–‡ä»¶å¤¹"><br>&#160; &#160; &#160; &#160;å†çœ‹çœ‹apké‡Œçš„å…¶ä»–æ–‡ä»¶å¤¹ï¼Œå¯ä»¥å‘ç°ï¼Œè¿™é‡Œé¢å¥½å¤šå¹¿å‘Šå’Œå…¶ä»–æ¸¸æˆå®£ä¼ å†…å®¹ï¼Œé‚£äº›æ²¡æœ‰åç¼€çš„æ–‡ä»¶é‡å‘½åä¸ºpngåç¼€å°±å¯çœ‹å‡ºæ¥äº†ã€‚ï¼ˆä¸æ¤å…¥å¹¿å‘Šè‚¿ä¹ˆèµšé’±ï¼Ÿ(â•¯â€µâ–¡â€²)â•¯ï¸µâ”»â”â”»ï¼‰<br>&#160; &#160; &#160; &#160;å¦å¤–æœç´¢äº†ä¸‹egret-gameï¼Œè¿™ä¸ªæ˜¯ä¸€æ¬¾HTML5çš„æ¸¸æˆå¼•æ“ï¼ŒEgretæ˜¯ç™½é¹­çš„æ„æ€ï¼Œæ®è¯´Egretæ¸¸æˆå¼•æ“å¯ä¸€æ¬¡å¼€å‘åˆ†åˆ«éƒ¨ç½²åœ¨androidã€IOSå’ŒWPåŸç”Ÿå¹³å°æˆ–è€…HTMLç‰ˆæœ¬ã€‚ã€Šå›´ä½ç¥ç»çŒ«ã€‹å°±æ˜¯è¿™ä¸ªå¼•æ“åšå‡ºæ¥çš„ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»çœ‹çœ‹ã€‚</p>
<h1 id="èµ„æºåˆ†æ"><a href="#èµ„æºåˆ†æ" class="headerlink" title="èµ„æºåˆ†æ"></a>èµ„æºåˆ†æ</h1><hr>
<h2 id="èµ„æºæè¿°æ–‡ä»¶resource-json"><a href="#èµ„æºæè¿°æ–‡ä»¶resource-json" class="headerlink" title="èµ„æºæè¿°æ–‡ä»¶resource.json"></a>èµ„æºæè¿°æ–‡ä»¶resource.json</h2><p>&#160; &#160; &#160; &#160;å…ˆæ¥çœ‹çœ‹æœ€å¤–é¢çš„æ–‡ä»¶resource.jsonï¼ˆtheme.thmè¿™ä¸ªæ˜¯ç©ºçš„æ‰€ä»¥ç•¥è¿‡ï¼‰ã€‚resource.jsonæ–‡ä»¶ä¸»è¦æ˜¯æ‰€æœ‰èµ„æºçš„æè¿°ä»¥åŠåˆ†ç»„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">"name"</span>:<span class="string">"block_json_json"</span>,</span><br><span class="line">	<span class="attr">"subkeys"</span>:<span class="string">"block_0,block_1,block_2,block_3,block_4,block_5,block_6,block_7,block_8,block_9,block_w"</span>,</span><br><span class="line">	<span class="attr">"type"</span>:<span class="string">"sheet"</span>,</span><br><span class="line">	<span class="attr">"url"</span>:<span class="string">"assets/block_json.json"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;è¿™ä¸€æ®µjsonä»£ç æ„æ€å°±æ˜¯block_json_jsonè¿™ä¸€ç»„é‡ŒåŒ…å«block_0.pngåˆ°block_w.pngå…±10ä¸ªæ–‡ä»¶ï¼Œè¿™é‡Œçœå»äº†åç¼€ã€‚urlå³è¿™ä¸€äº›èµ„æºå¯¹åº”çš„æ‰“åŒ…æ•°æ®æ–‡ä»¶ï¼Œå³assets/block_json.jsoné‡ŒåŒ…å«äº†è¿™åå¼ å›¾ç‰‡çš„æ‰“åŒ…æ•°æ®ï¼Œä¾‹å¦‚ï¼šä½ç½®ã€å®½é«˜ç­‰ã€‚</p>
<h2 id="æ‰“åŒ…èµ„æºæ•°æ®æ–‡ä»¶"><a href="#æ‰“åŒ…èµ„æºæ•°æ®æ–‡ä»¶" class="headerlink" title="æ‰“åŒ…èµ„æºæ•°æ®æ–‡ä»¶"></a>æ‰“åŒ…èµ„æºæ•°æ®æ–‡ä»¶</h2><p>&#160; &#160; &#160; &#160;æ¥ä¸‹æ¥çœ‹çœ‹assetsé‡Œéƒ½æœ‰å•¥ï¼š<br><img src="../images/Trigger/assets.png" alt="assetsç›®å½•"><br>&#160; &#160; &#160; &#160;å¯ä»¥çœ‹å‡ºassetsé‡Œå­˜æ”¾äº†æ¸¸æˆä¸­æ‰€æœ‰çš„èµ„æºï¼ŒåŒ…æ‹¬éŸ³æ•ˆã€å›¾ç‰‡ä»¥åŠæ‰“åŒ…å›¾ç‰‡å¯¹åº”çš„jsonæ–‡ä»¶ç­‰ã€‚å…ˆæ‰“å¼€ä¸€ä¸ªjsonæ–‡ä»¶çœ‹çœ‹æ˜¯æ€ä¹ˆæ‰“åŒ…å›¾ç‰‡çš„ï¼Œä»¥block_json.jsonä¸ºä¾‹ï¼Œblock_json.jsonä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"file"</span>:<span class="string">"block.png"</span>,<span class="attr">"frames"</span>:&#123;</span><br><span class="line"><span class="attr">"block_1"</span>:&#123;<span class="attr">"x"</span>:<span class="number">1</span>,<span class="attr">"y"</span>:<span class="number">1</span>,<span class="attr">"w"</span>:<span class="number">60</span>,<span class="attr">"h"</span>:<span class="number">63</span>,<span class="attr">"offX"</span>:<span class="number">0</span>,<span class="attr">"offY"</span>:<span class="number">0</span>,<span class="attr">"sourceW"</span>:<span class="number">60</span>,<span class="attr">"sourceH"</span>:<span class="number">63</span>&#125;,</span><br><span class="line"><span class="attr">"block_2"</span>:&#123;<span class="attr">"x"</span>:<span class="number">63</span>,<span class="attr">"y"</span>:<span class="number">1</span>,<span class="attr">"w"</span>:<span class="number">60</span>,<span class="attr">"h"</span>:<span class="number">63</span>,<span class="attr">"offX"</span>:<span class="number">0</span>,<span class="attr">"offY"</span>:<span class="number">0</span>,<span class="attr">"sourceW"</span>:<span class="number">60</span>,<span class="attr">"sourceH"</span>:<span class="number">63</span>&#125;,</span><br><span class="line"><span class="attr">"block_3"</span>:&#123;<span class="attr">"x"</span>:<span class="number">125</span>,<span class="attr">"y"</span>:<span class="number">1</span>,<span class="attr">"w"</span>:<span class="number">60</span>,<span class="attr">"h"</span>:<span class="number">63</span>,<span class="attr">"offX"</span>:<span class="number">0</span>,<span class="attr">"offY"</span>:<span class="number">0</span>,<span class="attr">"sourceW"</span>:<span class="number">60</span>,<span class="attr">"sourceH"</span>:<span class="number">63</span>&#125;,</span><br><span class="line"><span class="attr">"block_4"</span>:&#123;<span class="attr">"x"</span>:<span class="number">187</span>,<span class="attr">"y"</span>:<span class="number">1</span>,<span class="attr">"w"</span>:<span class="number">60</span>,<span class="attr">"h"</span>:<span class="number">63</span>,<span class="attr">"offX"</span>:<span class="number">0</span>,<span class="attr">"offY"</span>:<span class="number">0</span>,<span class="attr">"sourceW"</span>:<span class="number">60</span>,<span class="attr">"sourceH"</span>:<span class="number">63</span>&#125;,</span><br><span class="line"><span class="attr">"block_5"</span>:&#123;<span class="attr">"x"</span>:<span class="number">1</span>,<span class="attr">"y"</span>:<span class="number">66</span>,<span class="attr">"w"</span>:<span class="number">60</span>,<span class="attr">"h"</span>:<span class="number">63</span>,<span class="attr">"offX"</span>:<span class="number">0</span>,<span class="attr">"offY"</span>:<span class="number">0</span>,<span class="attr">"sourceW"</span>:<span class="number">60</span>,<span class="attr">"sourceH"</span>:<span class="number">63</span>&#125;,</span><br><span class="line"><span class="attr">"block_6"</span>:&#123;<span class="attr">"x"</span>:<span class="number">63</span>,<span class="attr">"y"</span>:<span class="number">66</span>,<span class="attr">"w"</span>:<span class="number">60</span>,<span class="attr">"h"</span>:<span class="number">63</span>,<span class="attr">"offX"</span>:<span class="number">0</span>,<span class="attr">"offY"</span>:<span class="number">0</span>,<span class="attr">"sourceW"</span>:<span class="number">60</span>,<span class="attr">"sourceH"</span>:<span class="number">63</span>&#125;,</span><br><span class="line"><span class="attr">"block_7"</span>:&#123;<span class="attr">"x"</span>:<span class="number">125</span>,<span class="attr">"y"</span>:<span class="number">66</span>,<span class="attr">"w"</span>:<span class="number">60</span>,<span class="attr">"h"</span>:<span class="number">63</span>,<span class="attr">"offX"</span>:<span class="number">0</span>,<span class="attr">"offY"</span>:<span class="number">0</span>,<span class="attr">"sourceW"</span>:<span class="number">60</span>,<span class="attr">"sourceH"</span>:<span class="number">63</span>&#125;,</span><br><span class="line"><span class="attr">"block_8"</span>:&#123;<span class="attr">"x"</span>:<span class="number">187</span>,<span class="attr">"y"</span>:<span class="number">66</span>,<span class="attr">"w"</span>:<span class="number">60</span>,<span class="attr">"h"</span>:<span class="number">63</span>,<span class="attr">"offX"</span>:<span class="number">0</span>,<span class="attr">"offY"</span>:<span class="number">0</span>,<span class="attr">"sourceW"</span>:<span class="number">60</span>,<span class="attr">"sourceH"</span>:<span class="number">63</span>&#125;,</span><br><span class="line"><span class="attr">"block_9"</span>:&#123;<span class="attr">"x"</span>:<span class="number">1</span>,<span class="attr">"y"</span>:<span class="number">131</span>,<span class="attr">"w"</span>:<span class="number">60</span>,<span class="attr">"h"</span>:<span class="number">63</span>,<span class="attr">"offX"</span>:<span class="number">0</span>,<span class="attr">"offY"</span>:<span class="number">0</span>,<span class="attr">"sourceW"</span>:<span class="number">60</span>,<span class="attr">"sourceH"</span>:<span class="number">63</span>&#125;,</span><br><span class="line"><span class="attr">"block_w"</span>:&#123;<span class="attr">"x"</span>:<span class="number">63</span>,<span class="attr">"y"</span>:<span class="number">131</span>,<span class="attr">"w"</span>:<span class="number">60</span>,<span class="attr">"h"</span>:<span class="number">63</span>,<span class="attr">"offX"</span>:<span class="number">0</span>,<span class="attr">"offY"</span>:<span class="number">0</span>,<span class="attr">"sourceW"</span>:<span class="number">60</span>,<span class="attr">"sourceH"</span>:<span class="number">63</span>&#125;,</span><br><span class="line"><span class="attr">"block_0"</span>:&#123;<span class="attr">"x"</span>:<span class="number">125</span>,<span class="attr">"y"</span>:<span class="number">131</span>,<span class="attr">"w"</span>:<span class="number">60</span>,<span class="attr">"h"</span>:<span class="number">63</span>,<span class="attr">"offX"</span>:<span class="number">0</span>,<span class="attr">"offY"</span>:<span class="number">0</span>,<span class="attr">"sourceW"</span>:<span class="number">60</span>,<span class="attr">"sourceH"</span>:<span class="number">63</span>&#125;&#125;&#125;</span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;æ˜¯çš„ï¼Œæ­£å¦‚åˆšåˆšæ‰€è¯´ï¼Œblock_json.jsonåŒ…å«äº†ä»block_1å¼€å§‹åˆ°block_0ç»“æŸåå¼ å›¾ç‰‡çš„æ‰“åŒ…æ•°æ®ã€‚è¿™é‡Œxå’Œyè¡¨ç¤ºå›¾ç‰‡ä¸­å¿ƒç‚¹åœ¨æ‰“åŒ…çš„å›¾ç‰‡block.pngä¸­çš„ä½ç½®ï¼Œwå’Œhè¡¨ç¤ºå›¾ç‰‡çš„æœ‰æ•ˆå®½é«˜ï¼ŒoffXå’ŒoffYè¡¨ç¤ºå›¾åƒåŒºåŸŸä¸­å¿ƒç‚¹ä¸æ•´ä½“åŒºåŸŸä¸­å¿ƒç‚¹çš„åç§»é‡ï¼ŒsourceWå’ŒsourceHè¡¨ç¤ºæºå›¾ç‰‡çš„å®½é«˜ã€‚</p>
<h2 id="å…³å¡æ•°æ®æ–‡ä»¶map-json"><a href="#å…³å¡æ•°æ®æ–‡ä»¶map-json" class="headerlink" title="å…³å¡æ•°æ®æ–‡ä»¶map.json"></a>å…³å¡æ•°æ®æ–‡ä»¶map.json</h2><p>&#160; &#160; &#160; &#160;æ¥ä¸‹æ¥è½¬åˆ°configç›®å½•ï¼Œå…ˆçœ‹çœ‹levelmap.jsonæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶åŒ…å«äº†åä¸ªå¤§å…³200ä¸ªå…³å¡çš„æ•°æ®ï¼Œé€‰å–ä¸€ä¸ªæœ‰ä»£è¡¨æ€§çš„å…³å¡æ•°æ®å¦‚ä¸‹æ‰€ç¤ºï¼š<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;"color":8,"id":20,"beat":6,"map":[[0,0,0,23,0,0,0],[0,0,2,2,0,0],[23,2,1,2,1,2,23],[2,2,1,1,2,2],[0,1,1,1,1,1,0],[2,2,1,1,2,2],[23,2,1,2,1,2,23],[0,0,2,2,0,0],[0,0,0,23,0,0,0]],"mapitem":["1_4_1","5_4_1"],"useritem":[2,2,2,3]&#125;,</span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;ä¸Šä¸€æ®µjsonä»£ç æè¿°çš„æ˜¯ç¬¬9å¤§å…³ï¼ˆä»0å¼€å§‹ï¼‰ç¬¬20å…³ï¼ˆä»1å¼€å§‹ï¼‰çš„å…³å¡æ•°æ®ï¼Œå…¶ä¸­colorè¡¨ç¤ºå…³å¡å¯¹åº”é¢œè‰²åºå·ï¼Œä¹Ÿè¡¨ç¤ºå¤§å…³å¡åºå·ï¼›idè¡¨ç¤ºå…³å¡åºå·ï¼›beatè¡¨ç¤ºæœ¬å…³å¯ç”¨ç‚¹å‡»æ¬¡æ•°ï¼›ä¹‹åçš„mapæ•°ç»„è¡¨ç¤ºå…³å¡ä¸­æ¯è¡Œæ¯åˆ—å¯¹åº”çš„å…­è¾¹å½¢çŠ¶æ€ã€‚å¯ä»¥çœ‹å‡ºï¼Œå…³å¡æ€»å…±æœ‰9è¡Œæ•°æ®ï¼Œå¥‡æ•°è¡Œæœ‰7ä¸ªæ•°å­—ï¼Œå¶æ•°è¡Œæœ‰6ä¸ªæ•°å­—ï¼Œæ¯ä¸ªæ•°å€¼å¯¹åº”æ¯ä¸€ä¸ªå…­è¾¹å½¢çš„çŠ¶æ€ï¼š0è¡¨ç¤ºè¯¥å…­è¾¹å½¢ä¸å­˜åœ¨ï¼Œ1è¡¨ç¤ºç™½è‰²ï¼Œ2è¡¨ç¤ºå…­è¾¹å½¢é¢œè‰²ä¸å…³å¡é¢œè‰²ç›¸åŒï¼Œå¤§äº2ä¸”å°äº10çš„æ•°è¡¨ç¤ºè¯¥å…­è¾¹å½¢é¢œè‰²ä¸ä¸»é¢˜è‰²ç›¸åŒä¸”åŒ…å«äº†æ•°å­—ï¼Œå€¼ä¸ºè¯¥æ•°å€¼å‡2ï¼›å¤§äº10çš„æ•°è¡¨ç¤ºè¯¥å…­è¾¹å½¢é¢œè‰²ä¸ºç™½è‰²ä¸”åŒ…å«äº†æ•°å­—ï¼Œæ•°å­—ä¸ºæœ€åä¸€ä½å‡1ï¼Œè¿™é‡Œ23å¯¹åº”çš„æ•°å­—ä¸º2ã€‚mapitemæ•°ç»„ä¸­æ¯ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºå¯¹åº”ä½ç½®åŒ…å«äº†ç®­å¤´ï¼Œä¾‹å¦‚ï¼šâ€1_4_1â€è¡¨ç¤ºç¬¬5è¡Œï¼ˆä»0å¼€å§‹ï¼‰ç¬¬2åˆ—ï¼ˆä»0å¼€å§‹ï¼‰æœ‰ç®­å¤´ï¼Œç®­å¤´åºå·ä¸º1ï¼›useritemæ•°ç»„ä¸­æ¯ä¸ªæ•°å­—è¡¨ç¤ºå¯¹åº”ä½ç½®å¯ç”¨çš„ç®­å¤´ï¼Œè¿™é‡Œâ€œ2,2,2,3â€è¡¨ç¤ºæœ‰4ä¸ªç®­å¤´å¯ç”¨ï¼ˆå¯æ”¾ç½®åœ¨ä»»æ„ä¸€ä¸ªå…­è¾¹å½¢ä¸Šï¼‰ï¼Œç®­å¤´åºå·åˆ†åˆ«ä¸º2ï¼Œ2ï¼Œ2ï¼Œ3ã€‚éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œç®­å¤´æœ‰ä»¥ä¸‹å››ç§ç±»å‹ï¼Œåºå·ä¸º0æ—¶è¡¨ç¤ºæ— ç®­å¤´ã€‚<br>åºå·ï¼š1ã€€ã€€ã€€ã€€å›¾ç‰‡ï¼š<img src="../images/Trigger/arrow1.png" alt=""><br>åºå·ï¼š2ã€€ã€€ã€€ã€€å›¾ç‰‡ï¼š<img src="../images/Trigger/arrow2.png" alt=""><br>åºå·ï¼š3ã€€ã€€ã€€ã€€å›¾ç‰‡ï¼š<img src="../images/Trigger/arrow3.png" alt=""><br>åºå·ï¼š4ã€€ã€€ã€€ã€€å›¾ç‰‡ï¼š<img src="../images/Trigger/arrow4.png" alt=""><br>&#160; &#160; &#160; &#160;levelmapss.jsonè¿™ä¸ªæ–‡ä»¶ç”±äºè¿˜ä¸æ¸…æ¥šä½œç”¨ï¼ˆå¯èƒ½æ˜¯é™„åŠ å…³å¡ï¼‰ï¼Œæ‰€ä»¥å…ˆç•¥è¿‡ã€‚</p>
<h1 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h1><p>ç¬¬ä¸€ç¯‡å…ˆå†™åˆ°è¿™ï¼Œå¦‚æœæœ‰ä»€ä¹ˆè¿˜ä¸å¤ªæ˜ç™½çš„åœ°æ–¹ï¼Œå¯ä»¥è”ç³»æˆ‘ã€‚</p>
]]></content>
      
        <categories>
            
            <category> Trigger </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Trigger </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[æ–°çš„å¼€å§‹]]></title>
      <url>/blog/2015/new-beginning.html</url>
      <content type="html"><![CDATA[<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>æµ‹è¯•æµ‹è¯•æµ‹è¯•æµ‹è¯•æµ‹è¯•æµ‹è¯•æµ‹è¯•æµ‹è¯•æµ‹è¯•æµ‹è¯•æµ‹è¯•æµ‹è¯•<a id="more"></a></p>
<p>ä»£ç æµ‹è¯•ï¼š</p>
<pre><code class="bash"><span class="comment">#include &lt;iostream&gt;</span>
using namespace std;ã€€ã€€
int main()ã€€ã€€
{ã€€ã€€
    cout &lt;&lt; <span class="string">"hello world!"</span> &lt;&lt; endl;ã€€ã€€
    <span class="built_in">return</span> 0;ã€€
}
</code></pre>
<p>å›¾ç‰‡æµ‹è¯•ï¼š<br><img src="../images/Visual Studio.png" alt="Visual Studio"></p>
]]></content>
      
        <categories>
            
            <category> éšç¬” </category>
            
        </categories>
        
        
    </entry>
    
  
  
</search>
